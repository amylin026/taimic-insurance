<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Taimicï½œAI æ™ºèƒ½è²¡å¯Œä¸­æ¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <!-- å¼•å…¥ Chart.js ç”¨æ–¼ç¹ªè£½åœ–è¡¨ -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%230057b8%22 rx=%222%22/><circle cx=%2250%22 cy=%2250%22 r=%2230%22 stroke=%22white%22 stroke-width=%228%22 fill=%22none%22/><rect x=%2246%22 y=%2220%22 width=%228%22 height=%2230%22 fill=%22white%22/></svg>" />

  <style>
    /* -------- 1. åŸºç¤è¨­å®š -------- */
    :root {
      --brand-primary: #0057b8; 
      --brand-dark: #003a7a;
      --brand-light: #f0f5fa;
      --brand-accent: #00c2cb; /* å¢åŠ ä¸€å€‹å¼·èª¿è‰² */
      
      --text-main: #1f2933;
      --text-sub: #52606d;
      --bg-body: #ffffff;
      --bg-section: #f8f9fa;
      --border-color: #e1e4e8;
      --radius-base: 4px; 
      --header-height: 80px;
      --max-width: 1280px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans TC", sans-serif;
      background: var(--bg-body);
      color: var(--text-main);
      line-height: 1.6;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    a { text-decoration: none; color: inherit; transition: all 0.2s; }
    button { font-family: inherit; border:none; background:none; cursor:pointer; }

    /* -------- 2. Header -------- */
    .site-header-wrap {
      position: sticky;
      top: 0;
      z-index: 1000;
      background: rgba(255, 255, 255, 0.98);
      border-bottom: 1px solid var(--border-color);
      backdrop-filter: blur(10px);
    }

    .site-header {
      max-width: var(--max-width);
      margin: 0 auto;
      height: var(--header-height);
      padding: 0 30px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .header-left { display: flex; align-items: center; gap: 12px; }
    .logo-icon {
      width: 40px; height: 40px; position: relative;
      border: 3px solid var(--brand-primary); border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
    }
    .logo-icon::before {
      content: ""; position: absolute; top: -3px; right: -3px;
      width: 12px; height: 12px; background: #fff;
    }
    .logo-icon::after {
      content: ""; position: absolute; width: 3px; height: 12px;
      background: var(--brand-primary); top: 6px; left: 50%; transform: translateX(-50%);
    }
    .logo-title { font-size: 24px; font-weight: 800; color: var(--brand-primary); letter-spacing: 0.5px; line-height: 1; }
    .logo-sub { font-size: 10px; color: var(--text-sub); letter-spacing: 1px; font-weight: 600; }

    .header-nav { display: flex; height: 100%; align-items: center; gap: 8px; }
    .nav-item {
      padding: 0 20px; font-size: 15px; font-weight: 600; color: var(--text-main);
      height: 100%; display: flex; align-items: center; position: relative;
    }
    .nav-item:hover { color: var(--brand-primary); background: var(--brand-light); }
    
    /* èªè¨€åˆ‡æ› */
    .header-right { position: relative; }
    .lang-btn {
      font-size: 14px; font-weight: 600; color: var(--text-sub);
      border: 1px solid var(--border-color); padding: 8px 16px;
      border-radius: var(--radius-base); background: #fff;
      display: flex; align-items: center; gap: 6px; min-width: 110px; justify-content: center;
    }
    .lang-btn:hover { border-color: var(--brand-primary); color: var(--brand-primary); }
    .lang-dropdown {
      position: absolute; top: 120%; right: 0; background: #fff;
      border: 1px solid var(--border-color); border-radius: var(--radius-base);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1); display: none;
      flex-direction: column; min-width: 110px; z-index: 2000; overflow: hidden;
    }
    .lang-dropdown.show { display: flex; }
    .lang-option { padding: 10px 16px; font-size: 14px; text-align: center; transition:0.2s; }
    .lang-option:hover { background: var(--brand-light); color: var(--brand-primary); }

    /* -------- 3. Hero -------- */
    .hero-wrap {
      background: linear-gradient(135deg, #ffffff 0%, #f0f5fa 100%);
      padding: 80px 0; border-bottom: 1px solid var(--border-color);
    }
    .container { max-width: var(--max-width); margin: 0 auto; padding: 0 30px; }
    
    .hero-title { font-size: 42px; font-weight: 800; margin-bottom: 20px; line-height: 1.2; }
    .hero-title span { color: var(--brand-primary); }
    .hero-desc { font-size: 18px; color: var(--text-sub); max-width: 600px; margin-bottom: 40px; }

    /* -------- 4. Tool Interface (æ–°ç‰ˆ) -------- */
    .tool-section { padding: 60px 0; background: #fff; min-height: 800px; }
    
    /* å·¦å³ä½ˆå±€ï¼šå·¦é‚Šè¼¸å…¥ï¼Œå³é‚Š Dashboard */
    .tool-container {
      display: grid; grid-template-columns: 320px 1fr; gap: 40px;
      align-items: start;
    }

    /* å·¦å´è¡¨å–® */
    .input-card {
      background: #fff; border: 1px solid var(--border-color);
      border-radius: 8px; padding: 30px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      position: sticky; top: 100px;
    }
    .form-group { margin-bottom: 20px; }
    .form-label { display: block; font-size: 14px; font-weight: 700; margin-bottom: 8px; color: #333; }
    .form-control {
      width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 4px; font-size: 15px;
    }
    .form-control:focus { border-color: var(--brand-primary); outline: none; }
    .btn-submit {
      width: 100%; background: var(--brand-primary); color: #fff;
      padding: 14px; font-weight: 700; border-radius: 4px; margin-top: 10px;
      transition: 0.3s;
    }
    .btn-submit:hover { background: var(--brand-dark); box-shadow: 0 4px 12px rgba(0,87,184,0.3); }

    /* å³å´ Dashboard */
    .dashboard-area { min-height: 500px; position: relative; }
    
    /* ç­‰å¾…ç‹€æ…‹ */
    .state-empty {
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      height: 100%; color: #999; border: 2px dashed #eee; border-radius: 8px; padding: 60px;
    }
    
    /* çµæœé¡¯ç¤ºå€ (é è¨­éš±è—) */
    .state-result { display: none; animation: fadeIn 0.5s ease; }
    @keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }

    /* Dashboard Grid */
    .dash-header { display: flex; justify-content: space-between; align-items: end; margin-bottom: 24px; border-bottom: 1px solid #eee; padding-bottom: 16px; }
    .dash-title { font-size: 24px; font-weight: 800; color: #111; }
    .dash-badge { background: #e3f2fd; color: var(--brand-primary); padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 700; }

    /* åœ–è¡¨å€ */
    .charts-row {
      display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 40px;
    }
    .chart-card {
      background: #fff; border: 1px solid var(--border-color); border-radius: 8px; padding: 24px;
    }
    .chart-head { font-size: 16px; font-weight: 700; margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }
    
    /* å•†å“æ¨è–¦å€ */
    .products-section h3 { font-size: 20px; font-weight: 700; margin-bottom: 20px; }
    .products-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
    
    .product-card {
      border: 1px solid var(--border-color); border-radius: 8px; overflow: hidden;
      transition: 0.3s; background: #fff; position: relative;
    }
    .product-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.08); border-color: var(--brand-primary); }
    .prod-tag {
      position: absolute; top: 12px; right: 12px; font-size: 10px; padding: 2px 8px;
      background: #333; color: #fff; border-radius: 2px;
    }
    .prod-body { padding: 20px; }
    .prod-company { font-size: 12px; color: #888; font-weight: 600; margin-bottom: 4px; }
    .prod-name { font-size: 16px; font-weight: 700; color: var(--brand-primary); margin-bottom: 12px; line-height: 1.4; }
    .prod-detail { font-size: 13px; color: #555; margin-bottom: 16px; }
    .prod-detail div { display: flex; justify-content: space-between; margin-bottom: 6px; border-bottom: 1px dotted #eee; padding-bottom: 2px; }
    .btn-order {
      width: 100%; background: #fff; border: 1px solid var(--brand-primary); color: var(--brand-primary);
      padding: 8px; border-radius: 4px; font-weight: 600; font-size: 13px;
    }
    .btn-order:hover { background: var(--brand-primary); color: #fff; }

    /* -------- 5. Floating AI Chat -------- */
    .ai-fab {
      position: fixed; bottom: 30px; right: 30px;
      width: 60px; height: 60px; background: var(--brand-primary);
      border-radius: 50%; box-shadow: 0 10px 25px rgba(0,87,184,0.4);
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; z-index: 2000; transition: 0.3s;
    }
    .ai-fab:hover { transform: scale(1.1); }
    .ai-fab svg { width: 30px; height: 30px; fill: #fff; }

    .chat-window {
      position: fixed; bottom: 100px; right: 30px;
      width: 350px; height: 450px; background: #fff;
      border-radius: 12px; box-shadow: 0 15px 40px rgba(0,0,0,0.15);
      display: none; flex-direction: column; overflow: hidden; z-index: 2000;
      border: 1px solid #eee;
    }
    .chat-header {
      background: var(--brand-primary); color: #fff; padding: 15px;
      font-weight: 700; display: flex; justify-content: space-between;
    }
    .chat-body { flex: 1; padding: 15px; overflow-y: auto; background: #f9f9f9; }
    .chat-msg { margin-bottom: 12px; max-width: 80%; padding: 10px; border-radius: 8px; font-size: 13px; }
    .msg-ai { background: #fff; border: 1px solid #eee; align-self: flex-start; color: #333; }
    .msg-user { background: #e3f2fd; color: #0057b8; margin-left: auto; text-align: right; }
    .chat-input-area {
      padding: 10px; border-top: 1px solid #eee; display: flex; gap: 8px; background: #fff;
    }
    .chat-input { flex: 1; border: 1px solid #ddd; padding: 8px; border-radius: 20px; font-size: 13px; outline: none; }

    /* RWD */
    @media (max-width: 960px) {
      .nav-item { display: none; }
      .tool-container { grid-template-columns: 1fr; }
      .charts-row { grid-template-columns: 1fr; }
      .products-grid { grid-template-columns: 1fr; }
      .input-card { position: static; }
    }
  </style>
</head>
<body>

  <!-- Header -->
  <div class="site-header-wrap">
    <header class="site-header">
      <div class="header-left">
        <div class="logo-icon"></div>
        <div class="logo-text-group">
          <div class="logo-title">Taimic</div>
          <div class="logo-sub">AI WEALTH HUB</div>
        </div>
      </div>
      <nav class="header-nav">
        <a href="#" class="nav-item" data-i18n="nav.market">ä¿éšªå¸‚é›†</a>
        <a href="#" class="nav-item" data-i18n="nav.invest">æ™ºèƒ½æŠ•é¡§</a>
        <a href="#" class="nav-item" data-i18n="nav.ai">AI è«®è©¢</a>
      </nav>
      <div class="header-right">
        <button class="lang-btn" onclick="toggleLangMenu()">
          <span>ğŸŒ</span> <span id="langLabel">ç¹é«”ä¸­æ–‡</span> <span>â–¾</span>
        </button>
        <div class="lang-dropdown" id="langDropdown">
          <div class="lang-option" onclick="selectLang('zh-Hant')">ç¹é«”ä¸­æ–‡</div>
          <div class="lang-option" onclick="selectLang('en')">English</div>
        </div>
      </div>
    </header>
  </div>

  <!-- Hero -->
  <div class="hero-wrap">
    <div class="container">
      <h1 class="hero-title" data-i18n="hero.title">AI é©…å‹•çš„<br><span>å…¨æ–¹ä½è²¡å¯Œé…ç½®å¹³å°</span></h1>
      <p class="hero-desc" data-i18n="hero.desc">æ•´åˆå…¨å°å£½éšªèˆ‡åŸºé‡‘å•†å“ï¼Œé€é AI æ¼”ç®—æ³•ç‚ºæ‚¨å®¢è£½åŒ–å°ˆå±¬çš„ä¿éšœèˆ‡æŠ•è³‡çµ„åˆã€‚ä¸€ç«™å¼æ¯”è¼ƒã€åˆ†æã€ä¸‹å–®ã€‚</p>
    </div>
  </div>

  <!-- Main Tool -->
  <div class="tool-section">
    <div class="container tool-container">
      
      <!-- 1. å·¦å´ï¼šKYC è¼¸å…¥ (Know Your Customer) -->
      <div class="input-card">
        <h3 style="margin-bottom:20px; font-weight:700;" data-i18n="form.title">å»ºç«‹æ‚¨çš„è²¡å¯Œæª”æ¡ˆ</h3>
        <form id="aiForm">
          <div class="form-group">
            <label class="form-label" data-i18n="form.age">å¹´é½¡</label>
            <input type="number" class="form-control" id="age" value="30">
          </div>
          <div class="form-group">
            <label class="form-label" data-i18n="form.status">å®¶åº­ç‹€æ³</label>
            <select class="form-control" id="status">
              <option value="single">å–®èº«æœªå©š (Single)</option>
              <option value="married">å·²å©šé ‚å®¢ (Married, No Kids)</option>
              <option value="family" selected>å·²å©šæœ‰å°å­© (Married w/ Kids)</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label" data-i18n="form.assets">å¯æŠ•è³‡è³‡ç”¢ (TWD)</label>
            <select class="form-control" id="assets">
              <option value="small">å°è³‡èµ·æ­¥ (< 100è¬)</option>
              <option value="mid" selected>ä¸­ç”¢ç©©å¥ (100è¬ - 500è¬)</option>
              <option value="high">é«˜æ·¨å€¼ (> 500è¬)</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label" data-i18n="form.risk">é¢¨éšªå±¬æ€§</label>
            <select class="form-control" id="risk">
              <option value="low">ä¿å®ˆå‹ (Conservative)</option>
              <option value="mid">å¹³è¡¡å‹ (Balanced)</option>
              <option value="high" selected>ç©æ¥µå‹ (Aggressive)</option>
            </select>
          </div>
          <button type="submit" class="btn-submit" data-i18n="form.btn">AI é‹ç®—æœ€ä½³é…ç½®</button>
        </form>
      </div>

      <!-- 2. å³å´ï¼šAI Dashboard -->
      <div class="dashboard-area">
        
        <!-- ç‹€æ…‹ A: ç©ºç™½ -->
        <div class="state-empty" id="stateEmpty">
          <div style="font-size:50px; margin-bottom:20px;">ğŸ¤–</div>
          <h3 data-i18n="wait.title">AI æº–å‚™å°±ç·’</h3>
          <p data-i18n="wait.desc">è«‹åœ¨å·¦å´è¼¸å…¥è³‡æ–™ï¼Œç³»çµ±å°‡ç‚ºæ‚¨åª’åˆæœ€ä½³å•†å“ã€‚</p>
        </div>

        <!-- ç‹€æ…‹ B: çµæœé¡¯ç¤º -->
        <div class="state-result" id="stateResult">
          
          <div class="dash-header">
            <div>
              <div class="dash-title" data-i18n="dash.title">æ‚¨çš„å°ˆå±¬è²¡å¯Œè—åœ–</div>
              <small style="color:#888;" id="userProfileText">Profile: 30æ­² / å·²å©šæœ‰å­ / ç©æ¥µå‹</small>
            </div>
            <span class="dash-badge">AI Generated</span>
          </div>

          <!-- åœ–è¡¨å€ -->
          <div class="charts-row">
            <!-- è³‡ç”¢é…ç½®åœ“é¤… -->
            <div class="chart-card">
              <div class="chart-head">
                <span>ğŸ“Š</span> <span data-i18n="chart.asset">å»ºè­°è³‡ç”¢é…ç½®</span>
              </div>
              <canvas id="assetChart"></canvas>
            </div>
            <!-- ä¿éšœç¼ºå£é›·é” -->
            <div class="chart-card">
              <div class="chart-head">
                <span>ğŸ›¡ï¸</span> <span data-i18n="chart.ins">ä¿éšœé˜²è­·ç¶²åˆ†æ</span>
              </div>
              <canvas id="radarChart"></canvas>
            </div>
          </div>

          <!-- å•†å“æ¨è–¦å€ (Aggregator æ¦‚å¿µ) -->
          <div class="products-section">
            <h3 data-i18n="prod.title">AI ç²¾é¸å•†å“æ¨è–¦ (Top Picks)</h3>
            
            <div class="products-grid" id="prodGrid">
              <!-- JS å‹•æ…‹ç”Ÿæˆå¡ç‰‡ -->
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

  <!-- Floating AI Chat Button -->
  <div class="ai-fab" onclick="toggleChat()">
    <svg viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg>
  </div>

  <!-- Chat Window -->
  <div class="chat-window" id="chatWindow">
    <div class="chat-header">
      <span>Taimic AI Assistant</span>
      <span style="cursor:pointer;" onclick="toggleChat()">Ã—</span>
    </div>
    <div class="chat-body" id="chatBody">
      <div class="chat-msg msg-ai">æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„ AI ç†è²¡é¡§å•ã€‚æœ‰é—œæ–¼ä¿éšªæ¯”è¼ƒæˆ–åŸºé‡‘é…ç½®çš„å•é¡Œå—ï¼Ÿ</div>
    </div>
    <div class="chat-input-area">
      <input type="text" class="chat-input" placeholder="è¼¸å…¥å•é¡Œ..." id="chatInput" onkeypress="handleChat(event)">
      <button style="color:var(--brand-primary); font-weight:600;" onclick="sendChat()">Send</button>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    // 1. èªè¨€åˆ‡æ›é‚è¼¯
    const i18n = {
      'zh-Hant': {
        'nav.market': 'ä¿éšªå¸‚é›†', 'nav.invest': 'æ™ºèƒ½æŠ•é¡§', 'nav.ai': 'AI è«®è©¢',
        'hero.title': 'AI é©…å‹•çš„<br><span>å…¨æ–¹ä½è²¡å¯Œé…ç½®å¹³å°</span>',
        'hero.desc': 'æ•´åˆå…¨å°å£½éšªèˆ‡åŸºé‡‘å•†å“ï¼Œé€é AI æ¼”ç®—æ³•ç‚ºæ‚¨å®¢è£½åŒ–å°ˆå±¬çš„ä¿éšœèˆ‡æŠ•è³‡çµ„åˆã€‚ä¸€ç«™å¼æ¯”è¼ƒã€åˆ†æã€ä¸‹å–®ã€‚',
        'form.title': 'å»ºç«‹æ‚¨çš„è²¡å¯Œæª”æ¡ˆ', 'form.age': 'å¹´é½¡', 'form.status': 'å®¶åº­ç‹€æ³', 'form.assets': 'å¯æŠ•è³‡è³‡ç”¢', 'form.risk': 'é¢¨éšªå±¬æ€§', 'form.btn': 'AI é‹ç®—æœ€ä½³é…ç½®',
        'wait.title': 'AI æº–å‚™å°±ç·’', 'wait.desc': 'è«‹åœ¨å·¦å´è¼¸å…¥è³‡æ–™ï¼Œç³»çµ±å°‡ç‚ºæ‚¨åª’åˆæœ€ä½³å•†å“ã€‚',
        'dash.title': 'æ‚¨çš„å°ˆå±¬è²¡å¯Œè—åœ–', 'chart.asset': 'å»ºè­°è³‡ç”¢é…ç½®', 'chart.ins': 'ä¿éšœé˜²è­·ç¶²åˆ†æ', 'prod.title': 'AI ç²¾é¸å•†å“æ¨è–¦'
      },
      'en': {
        'nav.market': 'Marketplace', 'nav.invest': 'Robo-Advisor', 'nav.ai': 'AI Chat',
        'hero.title': 'AI-Driven<br><span>Wealth Management Hub</span>',
        'hero.desc': 'Aggregating insurance and funds. We use AI algorithms to customize your protection and investment portfolio. Compare, Analyze, Order.',
        'form.title': 'Build Your Profile', 'form.age': 'Age', 'form.status': 'Family Status', 'form.assets': 'Investable Assets', 'form.risk': 'Risk Profile', 'form.btn': 'Run AI Analysis',
        'wait.title': 'AI Ready', 'wait.desc': 'Input your data on the left to generate recommendations.',
        'dash.title': 'Your Wealth Blueprint', 'chart.asset': 'Asset Allocation', 'chart.ins': 'Protection Analysis', 'prod.title': 'AI Top Picks'
      }
    };

    let currentLang = 'zh-Hant';
    const langLabel = document.getElementById('langLabel');
    const langDropdown = document.getElementById('langDropdown');

    function toggleLangMenu() { langDropdown.classList.toggle('show'); }
    document.addEventListener('click', (e) => {
      if (!document.querySelector('.header-right').contains(e.target)) langDropdown.classList.remove('show');
    });
    function selectLang(lang) {
      currentLang = lang;
      langLabel.textContent = (lang === 'zh-Hant') ? 'ç¹é«”ä¸­æ–‡' : 'English';
      const dict = i18n[lang];
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (dict[key]) el.innerHTML = dict[key];
      });
      langDropdown.classList.remove('show');
    }

    // 2. åœ–è¡¨èˆ‡ Dashboard é‚è¼¯
    let assetChartInstance = null;
    let radarChartInstance = null;

    document.getElementById('aiForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      // ç°¡å–®æ¨¡æ“¬ Loading
      const btn = this.querySelector('button');
      const orgText = btn.textContent;
      btn.textContent = 'AI Computing...';
      btn.style.opacity = 0.7;

      setTimeout(() => {
        btn.textContent = orgText;
        btn.style.opacity = 1;
        renderDashboard();
      }, 1000);
    });

    function renderDashboard() {
      document.getElementById('stateEmpty').style.display = 'none';
      document.getElementById('stateResult').style.display = 'block';
      
      const risk = document.getElementById('risk').value;
      const status = document.getElementById('status').value;
      
      // æ›´æ–° Profile æ–‡å­—
      document.getElementById('userProfileText').textContent = `Profile: ${document.getElementById('age').value}æ­² / ${status} / ${risk}`;

      // A. ç¹ªè£½è³‡ç”¢é…ç½®åœ– (Pie Chart)
      const ctxAsset = document.getElementById('assetChart').getContext('2d');
      let assetData = [];
      if(risk === 'high') assetData = [10, 20, 70]; // ç¾é‡‘, å‚µåˆ¸, è‚¡ç¥¨
      else if(risk === 'mid') assetData = [20, 40, 40];
      else assetData = [40, 40, 20];

      if(assetChartInstance) assetChartInstance.destroy();
      assetChartInstance = new Chart(ctxAsset, {
        type: 'doughnut',
        data: {
          labels: ['ç¾é‡‘ (Cash)', 'å‚µåˆ¸ (Bonds)', 'è‚¡ç¥¨/ETF (Stocks)'],
          datasets: [{
            data: assetData,
            backgroundColor: ['#e1e4e8', '#52606d', '#0057b8']
          }]
        },
        options: { responsive: true, plugins: { legend: { position: 'bottom' } } }
      });

      // B. ç¹ªè£½é›·é”åœ– (Radar Chart)
      const ctxRadar = document.getElementById('radarChart').getContext('2d');
      // æ ¹æ“šå®¶åº­ç‹€æ³æ¨¡æ“¬ç¼ºå£
      let radarData = [80, 70, 60, 50, 40]; // å£½éšª, é†«ç™‚, é‡å¤§å‚·ç—…, ç™Œç—‡, å¤±èƒ½
      if(status === 'family') radarData = [40, 50, 60, 70, 50]; // æœ‰å°å­©ï¼Œå£½éšªåˆ†æ•¸è®Šä½(ç¼ºå£å¤§)
      
      if(radarChartInstance) radarChartInstance.destroy();
      radarChartInstance = new Chart(ctxRadar, {
        type: 'radar',
        data: {
          labels: ['å£½éšª', 'é†«ç™‚', 'é‡å¤§å‚·ç—…', 'ç™Œç—‡', 'å¤±èƒ½'],
          datasets: [{
            label: 'ç›®å‰ä¿éšœåˆ†æ•¸ (Score)',
            data: radarData,
            backgroundColor: 'rgba(0, 87, 184, 0.2)',
            borderColor: '#0057b8',
            pointBackgroundColor: '#0057b8'
          }]
        },
        options: { 
          scales: { r: { beginAtZero: true, max: 100 } },
          plugins: { legend: { display: false } }
        }
      });

      // C. ç”Ÿæˆæ¨è–¦å•†å“å¡ç‰‡
      renderProducts(risk, status);
    }

    function renderProducts(risk, status) {
      const grid = document.getElementById('prodGrid');
      grid.innerHTML = '';

      // æ¨¡æ“¬å•†å“è³‡æ–™åº«
      const products = [
        {
          type: 'insurance',
          company: 'å¯Œé‚¦äººå£½ (Fubon)',
          name: 'é†«å®šå®‰å¿ƒé‡å¤§å‚·ç—…éšª',
          tag: 'é†«ç™‚é¦–é¸',
          desc: 'é‡å°ç™Œç—‡èˆ‡æ…¢æ€§ç—…æä¾›ä¸€æ¬¡æ€§çµ¦ä»˜ï¼Œé©åˆå®¶åº­æ”¯æŸ±ã€‚',
          match: status === 'family' || status === 'married'
        },
        {
          type: 'insurance',
          company: 'åœ‹æ³°äººå£½ (Cathay)',
          name: 'ç¾æ»¿äººç”Ÿå®šæœŸå£½éšª',
          tag: 'é«˜CPå€¼',
          desc: 'ç´”ä¿éšœå‹å•†å“ï¼Œç”¨ä½ä¿è²»æ›å–é«˜é¡å£½éšªä¿éšœã€‚',
          match: status === 'family'
        },
        {
          type: 'invest',
          company: 'å…ƒå¤§æŠ•ä¿¡ (Yuanta)',
          name: '0050 å°ç£å“è¶Š50',
          tag: 'ç©©å¥æˆé•·',
          desc: 'è¿½è¹¤å°è‚¡å‰50å¤§å¸‚å€¼å…¬å¸ï¼Œé©åˆé•·æœŸæŒæœ‰ã€‚',
          match: risk === 'mid' || risk === 'high'
        },
        {
          type: 'invest',
          company: 'Vanguard',
          name: 'Vanguard Total World (VT)',
          tag: 'å…¨çƒåˆ†æ•£',
          desc: 'ä¸€æª”ETFè²·ä¸‹å…¨ä¸–ç•Œï¼Œé¢¨éšªåˆ†æ•£çš„æœ€ä½³é¸æ“‡ã€‚',
          match: true // å¤§å®¶éƒ½é©åˆ
        },
        {
          type: 'invest',
          company: 'PIMCO',
          name: 'å¤šå…ƒæ”¶ç›Šå‚µåˆ¸åŸºé‡‘',
          tag: 'å›ºå®šæ”¶ç›Š',
          desc: 'æä¾›ç©©å®šæœˆé…æ¯ï¼Œé©åˆä½œç‚ºè³‡ç”¢é˜²ç¦¦éƒ¨ä½ã€‚',
          match: risk === 'low' || risk === 'mid'
        }
      ];

      // ç¯©é¸ä¸¦é¡¯ç¤º
      products.forEach(p => {
        if(p.match) {
          const card = document.createElement('div');
          card.className = 'product-card';
          card.innerHTML = `
            <div class="prod-tag">${p.tag}</div>
            <div class="prod-body">
              <div class="prod-company">${p.company}</div>
              <div class="prod-name">${p.name}</div>
              <div class="prod-detail">
                <div><span>é¡å‹</span> <span>${p.type === 'insurance' ? 'ä¿éšª' : 'æŠ•è³‡'}</span></div>
                <p style="margin-top:8px; font-size:12px; line-height:1.5;">${p.desc}</p>
              </div>
              <button class="btn-order" onclick="alert('å·²å°‡ ${p.name} åŠ å…¥æ¯”è¼ƒæ¸…å–®')">åŠ å…¥æ¯”è¼ƒ / è©¦ç®—</button>
            </div>
          `;
          grid.appendChild(card);
        }
      });
    }

    // 3. Chatbot é‚è¼¯
    const chatWindow = document.getElementById('chatWindow');
    function toggleChat() {
      if(chatWindow.style.display === 'flex') chatWindow.style.display = 'none';
      else chatWindow.style.display = 'flex';
    }
    
    function handleChat(e) { if(e.key === 'Enter') sendChat(); }
    
    function sendChat() {
      const input = document.getElementById('chatInput');
      const text = input.value.trim();
      if(!text) return;
      
      // Add User Msg
      addMsg(text, 'user');
      input.value = '';

      // Fake AI Reply
      setTimeout(() => {
        let reply = "é€™æ˜¯ä¸€å€‹å¾ˆå¥½çš„å•é¡Œã€‚æ ¹æ“šæ‚¨çš„è³‡ç”¢è¦æ¨¡ï¼Œæˆ‘å»ºè­°å¯ä»¥å…ˆå¾é…ç½® 20% çš„ç¾å…ƒå‚µåˆ¸é–‹å§‹...";
        if(text.includes("ä¿éšª")) reply = "é—œæ–¼ä¿éšªï¼Œå¦‚æœæ‚¨æœ‰å®¶åº­è²¬ä»»ï¼Œå»ºè­°å„ªå…ˆè¦åŠƒã€å®šæœŸå£½éšªã€èˆ‡ã€å¯¦æ”¯å¯¦ä»˜ã€ã€‚";
        if(text.includes("è‚¡ç¥¨") || text.includes("ETF")) reply = "ç›®å‰çš„å¸‚å ´æ³¢å‹•è¼ƒå¤§ï¼Œå®šæœŸå®šé¡æŠ•å…¥å¤§ç›¤å‹ ETF (å¦‚ 0050 æˆ– VOO) æ˜¯æ¯”è¼ƒç©©å¥çš„ç­–ç•¥ã€‚";
        
        addMsg(reply, 'ai');
      }, 1000);
    }

    function addMsg(text, type) {
      const div = document.createElement('div');
      div.className = `chat-msg msg-${type}`;
      div.textContent = text;
      document.getElementById('chatBody').appendChild(div);
      // Scroll to bottom
      document.getElementById('chatBody').scrollTop = document.getElementById('chatBody').scrollHeight;
    }

  </script>
</body>
</html>
